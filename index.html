<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    
    <title>Chess exercise</title>

    <link rel="stylesheet" href="https://pyscript.net/alpha/pyscript.css" />
        <script defer src="https://pyscript.net/alpha/pyscript.js"></script>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
        <style type="text/css">
            rect.square.dark {
                fill: #8ec1ef;
            }
            rect.square.light {
                fill: #eeefe7
            }
        </style>
    
        <py-env>
        - chess
        </py-env>   
        <py-script src="chess_script.py">
        </py-script>
        <script type="text/javascript">
            var x = "";
            var y = "";
            function get_object() {
                return x + y;
            };
            document.addEventListener('click', function (event) {
                 xmap = {
                    '0':'a',
                    '1':'b',
                    '2':'c',
                    '3':'d',
                    '4':'e',
                    '5':'f',
                    '6':'g',
                    '7':'h',
                }
                ymap = {
                    '0':'8',
                    '1':'7',
                    '2':'6',
                    '3':'5',
                    '4':'4',
                    '5':'3',
                    '6':'2',
                    '7':'1',
                }
                if (!event.target.matches('use')) {
                    x = "";
                    y = "";
                    return
                };
                piece = event.target.getAttribute('transform').match(/\d+/g);
                x = xmap[(piece[0] - 15) / 45];
                y = ymap[(piece[1] - 15) / 45];
                //x = piece[0];
                //y = piece[1];
                //console.log('Clicked piece at: ' + x + y);
            }, false);
        </script>
</head>

<body>
    <script type="text/javascript">
        var x = "";
        var y = "";
      
        function get_object() {
          return x + y;
        };
        document.addEventListener('click', function(event) {
          xmap = {
            '0': 'a',
            '1': 'b',
            '2': 'c',
            '3': 'd',
            '4': 'e',
            '5': 'f',
            '6': 'g',
            '7': 'h',
          }
          ymap = {
            '0': '8',
            '1': '7',
            '2': '6',
            '3': '5',
            '4': '4',
            '5': '3',
            '6': '2',
            '7': '1',
          }
          if (!event.target.matches('use')) {
            x = "";
            y = "";
            return
          };
          piece = event.target.getAttribute('transform').match(/\d+/g);
          x = xmap[(piece[0] - 15) / 45];
          y = ymap[(piece[1] - 15) / 45];
          //x = piece[0];
          //y = piece[1];
          //console.log('Clicked piece at: ' + x + y);
        }, false);
      </script>

    <header>
        <h1>Chess exercise</h1>
    </header>
    <div class="content">
        <div class="left-section">
            <div class="main-div">
                <!-- 700px by 700px div -->
                <div id="svg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.2" baseProfile="tiny" viewBox="0 0 390 390" width="700" height="700">
                    <rect x="0" y="0" width="390" height="390" fill="#30ac10" />
                  </svg></div>
            </div>
            <div class="inputs">
                <label for="inputM">M:</label>
                <input type="text" id="inputM" placeholder="M" value="200">
                <label for="inputK">k:</label>
                <input type="text" id="inputK" placeholder="k" value="1">
            </div>
            <div class="buttons">
                <button id="calculateButton" pys-onClick="calculateClicked">Calculate</button>
                <button id="nextButton" pys-onClick="nextClicked">Next position</button>
                <button id="prevButton" pys-onClick="prevClicked">Previous position</button>
                
            </div>
        </div>
        <div class="right-section">
            <textarea class="output" id="output"></textarea>
        </div>
    </div>
</body>

</html>
